var QuickOutput={pageSelected:false,selectExportType:"",selectPageTriggersRangeSelection:true,isFullRecord:function(){return $("#records_chunks").length===0},isMarkedList:function(){var b=$("#output_form");if(!b.length){return false}var c=b.find('input[name="search_mode"]');if(!c.length){return false}var a=c.val();if(typeof a==="undefined"){return false}return a==="MarkedList"},isSafari:Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor")>0,removeAddToENWButton:function(){if(QuickOutput.isFullRecord()&&$('[id^="enw_link"]').children().length){$(".quickOutputENW").filter("a").parent("li").remove();var e=$(".saveToMenu").find("a").first();var a=e.text();var b=e.attr("class").split(/\s+/);var c="";$.each(b,function(f,g){if(g.indexOf("quickOutput")===0){c=g}});if(c.length){var d=$(".saveAgainTo").filter(".quickOutputENW").removeClass("quickOutputENW").unbind("click").addClass(c).click(function(f){f.preventDefault();$(".saveToMenu").find("a."+c).click()}).find("span").text(a)}}},selectionsAvailable:function(){if(typeof jQuery!=="undefined"){return $('input[name="marked_list_candidates"]').length>0}}};var captcha={token:null,recaptchaVerified:false,userSIDVerify:null,executeRecaptcha:function(){captcha.token=grecaptcha.getResponse();if(captcha.token==null||captcha.token==""){grecaptcha.reset();grecaptcha.execute()}return captcha.token},validateRecaptcha:function(a){captcha.executeRecaptcha();if(captcha.token){var b=$("#recaptchaUrl").first().text();captcha.userSIDVerify=$("#captcha_token").val();$.ajax({type:"POST",async:false,url:b,data:{response:captcha.token},success:captcha.checkToken,error:function(){captcha.recaptchaVerified=true}})}},checkToken:function(a){var b=a.success;if(b===true){captcha.userSIDVerify=captcha.token;captcha.recaptchaVerified=true}else{captcha.recaptchaVerified=false}},};(function(z){_.templateSettings={interpolate:/\<\@\=(.+?)\@\>/gim,evaluate:/\<\@(.+?)\@\>/gim,escape:/\<\@\-(.+?)\@\>/gim};var B=Backbone.View.extend({el:z(".saveTo"),initialize:function(){_.bindAll(this,"render","showActions");this.render();return this},render:function(){if(this.$el.size()===0){this.$el=z(".saveTo")}this.$el.button({text:false,icons:{primary:"ui-icon-triangle-1-s"}}).click(this.showActions);return this},showActions:function(R){disable_auto_submit();$this=z(R.currentTarget);$button=$this.parent();var P=z(document).height()/2;var Q=$button.position().top;var O=Q<=P;var S=$button.next().show();S.css({visibility:"visible"}).position({my:O?"left top":"left bottom",at:O?"left bottom":"left top",of:$button.parent().find(".saveAgainTo")});z(document).one("click",function(){S.hide()});return false}});var l=Backbone.View.extend({el:z(".saveAgainTo"),initialize:function(){_.bindAll(this,"render","doPreviousAction");this.render();return this},render:function(){if(this.$el.size()===0){this.$el=z(".saveAgainTo")}this.$el.button().click(this.doPreviousAction);return this},doPreviousAction:function(){return false}});var N=Backbone.Model.extend({});var m=Backbone.View.extend({el:z(".formatForPrintButton"),extraParams:"",format:"formatForPrint",idPrefix:"qoPrint",paramHelper:function(O){return""},shouldRemoveRurl:true,overlayButtonsetClass:"quickoutput-overlay-buttonset",overlayActionClass:"quickoutput-action",overlayCancelActionClass:"quickoutput-cancel-action",notEntitleCloseActionTemplate:_.template(z("#qoNotEntitleCloseActionTemplate").html()),recordSelectedTemplate:_.template(z("#qoRecordSelectedTemplate").html()),recordsSelectedTemplate:_.template(z("#qoRecordsSelectedTemplate").html()),numberOfRecordsTemplate:_.template(z("#qoNumberOfRecordsTemplate").html()),sendingTemplate:_.template(z("#qoSendingTemplate").html()),hiddenValuesTemplate:_.template(z("#qoHiddenValuesTemplate").html()),optionalEmailValidationError:z("#qoOptionalEmailValidationError").html(),requiredEmailValidationError:z("#qoRequiredEmailValidationError").html(),actionButtonsTemplate:function(){var O=this;return _.template('<div class="'+O.overlayButtonsetClass+'"><span class="'+O.overlayActionClass+'"><@= action @></span><a class="'+O.overlayCancelActionClass+'" href="#"><@= cancelaction @></a></div>')},getTemplateContents:function(P,Q){var R=this.idPrefix;if(Q!==undefined){R=Q}var O=z("#"+R+P+"Template");return O.length?O.html():null},templateFactory:function(P,O){var Q=this.getTemplateContents(P);if(Q!==null){return _.template(Q)}if(O){Q=this.getTemplateContents(P,"qo");if(Q!==null){return _.template(Q)}}return _.template("")},buttonTemplate:function(){return this.templateFactory("Button")},titleTemplate:function(){return this.templateFactory("Title")},contentTemplate:function(){return this.templateFactory("Content",true)},detailsTemplate:function(){return this.templateFactory("Details")},actionTemplate:function(){return this.templateFactory("Action",true)},sendingTitleTemplate:function(){return this.templateFactory("SendingTitle")},sendingMessageTemplate:function(){return this.templateFactory("SendingMessage",true)},sendingOneMessageTemplate:function(){return this.templateFactory("SendingOneMessage",true)},sentTitleTemplate:function(){return this.templateFactory("SentTitle")},sentMessageTemplate:function(){return this.templateFactory("SentMessage",true)},sentOneMessageTemplate:function(){return this.templateFactory("SentOneMessage",true)},instructionActionTemplate:function(){return this.templateFactory("InstructionAction",true)},hasIncitesEntitleTemplate:function(){return this.templateFactory("HasIncitesEntitle",true)},noIncitesEntitleTemplate:function(){return this.templateFactory("NoIncitesEntitle",true)},datasetMaxTemplate:function(){return this.templateFactory("DatasetMax",true)},cancelActionTemplate:function(){return this.templateFactory("CancelAction",true)},saveActionTemplate:function(){return this.templateFactory("SaveAction",true)},closeActionTemplate:function(){return this.templateFactory("CloseAction",true)},sentCloseActionTemplate:function(){return this.templateFactory("SentCloseAction",true)},errorTemplate:function(){return this.templateFactory("Error",true)},sentTemplate:function(){return this.templateFactory("Sent",true)},initialize:function(O){_.bindAll(this,"isRangeSelected","numberOfRecordsSelected","formInvalid","numberOfRecordsForRange","prepValidator","render","selectionParams","formatNumberWithcommas","baseUrl","downloadFile","handleError","postData","requestUrl","classText","selectCheckBox","allRecordsOnPage","doAction","doCancelAction","doDoneAction","doRefreshAction","fixMode","saveDoAgain","showOptions","showProcessing","showConfirmation","actionButtonsTemplate","invalidMarkedListOptions","numberOfProcessedRecords","postToNewWindow","rangeFieldsInMaxRecordLimit","removeRurl","saveEmailAddress","selectionsInMarkedListRecordLimit","setFilters","setModel","setRangeParameters","showError","showFormattedError","showJsonError","submitForm","uncheckSelections");if(typeof O!=="undefined"&&typeof O.model!=="undefined"){this.model=O.model}this.render();return this},render:function(){var O=this;O.$el.html(O.buttonTemplate()());O.$el.find('[type="image"]').click(function(P){if(typeof crCharts!=="undefined"&&crCharts!==null){QuickOutput.selectExportType="print";crCharts.publishedItems.renderExportChart();crCharts.timesCited.renderExportChart()}O.showOptions(P)});O.$el.show();O.$el.css({visibility:"visible"});return O},fixMode:function(V,Q){var P=this;var U=z(Q).find('input[name="search_mode"]').val();var T=z(Q).find('input[name="colName"]').val();var S=z(V).find('input[name="mode"]').val();if(S==="quickOutputForCited"&&T==="DIIDW"){if(P.idPrefix!=="qoEmail"){z(Q).find('input[name="mode"]').val("OpenQuickOutputForCited")}return}var R=z(Q).find('input[name="use_two_ets"]').val();if(P.idPrefix=="qoIncites"&&R=="true"){z(Q).find('input[name="mode"]').val("outputServiceForInCites");z(V).find('input[name="mode"]').val("outputServiceForInCites");return}var W=z(Q).find('input[name="research_id"]').val();var O=z(Q).find('input[name="admin_rid"]').val();if(P.shouldSignIn&&typeof W!=="undefined"&&typeof O!=="undefined"&&(P.idPrefix==="qoRID"||P.idPrefix==="qodistinctAuthorSet")){z(Q).find('input[name="mode"]').val("outputServiceForClaimPublications");z(V).find('input[name="mode"]').val("outputServiceForClaimPublications");return}if(P.fileDownload){z(Q).find('input[name="mode"]').val(U==="CitedRefList"?"CitedRefList-OpenOutputService":S==="quickOutputForUATODII"?"OpenQuickOutputForUATODII":T==="DIIDW"?"OpenQuickOutputForDII":"OpenOutputService");z(V).find('input[name="mode"]').val(U==="CitedRefList"?"CitedRefList-OpenOutputService":S==="quickOutputForUATODII"?"OpenQuickOutputForUATODII":T==="DIIDW"?"OpenQuickOutputForDII":"OpenOutputService")}else{if(P.mode){if(P.formName){z(Q).find('input[name="mode"]').val((U==="CitedRefList"?"CitedRefList-":"")+P.mode)}else{z(V).find('input[name="mode"]').val((U==="CitedRefList"?"CitedRefList-":"")+P.mode)}}}if(QuickOutput.isMarkedList()&&(P.idPrefix==="qoEmail"||P.idPrefix=="qoENW"||P.idPrefix=="qoRID"||P.idPrefix=="qoRefWorks"||P.idPrefix=="qoIncites")){if(T==="DIIDW"){z(Q).find('input[name="mode"]').val("quickOutputForDII");z(V).find('input[name="mode"]').val("quickOutputForDII");return}else{z(Q).find('input[name="mode"]').val("outputService");z(V).find('input[name="mode"]').val("outputService");return}}},invalidMarkedListOptions:function(){var S="#output_form";var Q=z(S);if(typeof Q==="undefined"||Q.length<1){return false}var P=Q.find('input[name="value(record_select_type)"]:checked');if(typeof P==="undefined"||P.length<1){return false}var O=this;var R=P.val();switch(R){case"range":if(O.idPrefix=="qoIncites"){return false}if(!O.bothRangeFieldsHaveValue(S)){alert(getMessageById("quickOutputNullInARange"));return true}if(!O.bothRangeFieldsAreNumbers(S)){alert(getMessageById("range_specialchar_error"));return true}if(!O.bothRangeFieldsInOrder(S)){alert(getMessageById("range_notsequential_error"));return true}if(!O.bothRangeFieldsInSet(S)){alert(getMessageById("range_notinset_error"));return true}if(!O.rangeFieldsInMaxRecordLimit(S)){if(O.idPrefix=="qoFastSave"){alert(getMessageById("qo_range_morethan_fastsave_error"))}else{alert(getMessageById("qo_range_morethan_maxrec_error"))}return true}break;case"allrecords":if(O.idPrefix=="qoIncites"||O.idPrefix=="qoFastSave"){break}if(CURRENT_NUM_MARKED_LIST_RECORDS>QUICK_OUTPUT_MAX_RECORDS){alert(getMessageById("ml_allrecs_morethan_maxrec_output_notice"));return false}break;case"pagerecordsByValue":case"selrecord":case"selrecords":default:}},removeRurl:function(P,Q){var O=this;if(O.shouldRemoveRurl){var R=z(Q).find('input[name="rurl"]');O.savedRurl=R.val();R.remove()}},saveEmailAddress:function(P,Q){var O=this;z.each([P,Q],function(S,R){var T=z(R).find('input[name="emailAddress"]');if(T.length&&T.val().length){z(P).find('input[name="emailAddress"]').val(T.val());z(Q).find('input[name="emailAddress"]').val(T.val());O.savedEmailAddress=T.val();return}})},fullRecordParams:function(O){var P=z('form[name="mark_records_form"]').find('[name="selectedIds"]').val();if(typeof P==="undefined"){P="1"}z(O).find('[name="value(record_select_type)"]').val("pagerecords");z(O).find("#mark_from").val(P);z(O).find("#mark_to").val(P);z(O).find("#filters").val(z(O).find('[name="fields_selection"]').val());return"&marked_list_candidates="+P+"&excludeEventConfig=ExcludeIfFromFullRecPage"},setRangeParameters:function(W,Q){var P=this;var Y=z(W).find('[name="markFrom"]').val();var S=z(W).find('[name="markTo"]').val();if(typeof Y==="undefined"||!Y.length||typeof S==="undefined"||!S.length){Y=z(Q).find('[name="markFrom"]').val();S=z(Q).find('[name="markTo"]').val();if(typeof Y==="undefined"||!Y.length||typeof S==="undefined"||!S.length){return}}var T=/^\s*(\d+)\s*$/;var O=Y.match(T);var U=S.match(T);if(!O||!U||O.length<2||U.length<2){return}var R=parseInt(O[1]);var X=parseInt(U[1]);if(R>X){var V=X;X=R;R=V}z(W).find("#mark_from").val(R);z(W).find("#mark_to").val(X);z(W).find("#selectedIds").val("");z(W).find('[name="selectedIds"]').val("");if(P.model){P.model.attributes.selectedIds=""}if(Q&&P.idPrefix!="qodistinctAuthorSet"){z(Q).find('[name="mark_from"]').val(R);z(Q).find('[name="mark_to"]').val(X);z(Q).find("#selectedIds").val("");z(Q).find('[name="selectedIds"]').val("")}},isRangeSelected:function(P,R){var O=z(R?R:P).find('[name="value(record_select_type)"]');if(!O.length){if(R){O=z(P).find('[name="value(record_select_type)"]')}if(!O.length){if(this.savedIsRangeSelected){return this.savedIsRangeSelected}return false}}var Q=O.filter(":checked");this.savedIsRangeSelected=!(Q.length<1||Q.val()!=="range");return this.savedIsRangeSelected},selectCheckBox:function(S,R){var P=this;var O=P.markedListCandidates.length;var Q=0;if(S){Q=S-1}if(!R){R=O}while(Q<R){P.markedListCandidates[Q].checked=true;Q++}return},numberOfRecordsSelected:function(){var P=this;P.markedListCandidates=z("#records_chunks").find('input[name="marked_list_candidates"]');if(QuickOutput.isMarkedList()){var W=z("#output_form").find('input[name="value(record_select_type)"]:checked').val();if(P.idPrefix=="qoFastSave"){if(CURRENT_NUM_MARKED_LIST_RECORDS>FAST_SAVE_MAX_RECORDS){return FAST_SAVE_MAX_RECORDS}else{return CURRENT_NUM_MARKED_LIST_RECORDS}}if(W==="allrecords"){if(CURRENT_NUM_MARKED_LIST_RECORDS>QUICK_OUTPUT_MAX_RECORDS){return QUICK_OUTPUT_MAX_RECORDS}return CURRENT_NUM_MARKED_LIST_RECORDS}if(W==="pagerecords"){return P.markedListCandidates.length}if(W==="range"){if(P.idPrefix=="qoIncites"){return document.getElementById("incitesCount").value}var Q=z("#output_form").find('input[name="markFrom"]').val();var Z=z("#output_form").find('input[name="markTo"]').val();var U=/^\s*(\d+)\s*$/;var X=Q.match(U);var aa=Z.match(U);var af=parseInt(X[1]);var S=parseInt(aa[1]);return S-af+1}}if(P.idPrefix==="qoRIDSignIn"&&P.outputViewType=="distincAuthorSet"){var ab=z("#loginForm").find('input[name="mark_from"]').val();var R=z("#loginForm").find('input[name="mark_to"]').val();P.outputToRID=R-ab+1;var ae=P.outputToRID;return parseInt(ae)}if(P.idPrefix==="qoRIDSignIn"&&P.outputViewType=="summary"){var ag=z("#loginForm").find('input[name="totalMarked"]').val();P.outputToRID=ag;return parseInt(ag)}if(P.idPrefix=="qoproxyClaim"){P.markedListCandidates=z("#ProxyClaimForm").find('input[name="rid_steamID"]');var O=z("#ProxyClaimForm").find('input[name="mark_from"]').val();var T=z("#ProxyClaimForm").find('input[name="mark_to"]').val();P.outputToProxyRID=T-O+1;var ae=P.outputToProxyRID;return parseInt(ae)}if(P.idPrefix=="qodistinctAuthorSet"){P.markedListCandidates=z("#summary_records_form").find('input[name="selectedId"]');var V=P.markedListCandidates.filter(":checked");var Y=P.markedListCandidates.filter(":checked").length;var ad=0;var ac=0;while(ac<Y){ad=parseInt(V[ac].getAttribute("utcount"))+ad;ac++}return ad+_.compact(z.trim(z("#summary_records_form").find('input[name="preSelectedIds"]').val()).split(" ")).length}return P.markedListCandidates.filter(":checked").length},numberOfProcessedRecords:function(){var O=this;if(!O.model){return 0}if(QuickOutput.isMarkedList()){if(O.idPrefix=="qoIncites"){ac=document.getElementById("incitesCount").value;return ac}if(O.idPrefix=="qoFastSave"){return CURRENT_NUM_MARKED_LIST_RECORDS>FAST_SAVE_MAX_RECORDS?FAST_SAVE_MAX_RECORDS:CURRENT_NUM_MARKED_LIST_RECORDS}var V=O.model.get("value(record_select_type)");switch(V){case"range":var P=O.model.get("markFrom");var X=O.model.get("markTo");var U=/^\s*(\d+)\s*$/;var W=P.match(U);var Y=X.match(U);var af=parseInt(W[1]);var R=parseInt(Y[1]);return R-af+1;break;case"pagerecords":return O.markedListCandidates.length;break;case"allrecords":default:if(CURRENT_NUM_MARKED_LIST_RECORDS>QUICK_OUTPUT_MAX_RECORDS){return QUICK_OUTPUT_MAX_RECORDS}return CURRENT_NUM_MARKED_LIST_RECORDS}}if((O.idPrefix==="qoRIDSignIn"&&(O.outputViewType=="distincAuthorSet"||O.outputViewType=="summary"))||O.idPrefix=="qoproxyClaim"){var aa=O.model.get("mark_from");var Q=O.model.get("mark_to");if(O.idPrefix=="qoproxyClaim"){aa=z("#ProxyClaimForm").find('input[name="mark_from"]').val();Q=z("#ProxyClaimForm").find('input[name="mark_to"]').val()}var ae=null;if(Q&&aa){ae=Q-aa+1}else{ae=O.model.get("totalMarked")}return ae>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:ae}if(O.idPrefix==="qoRIDSignIn"&&O.outputViewType=="summary"){var ag=O.model.get("totalMarked");if(!ag){var aa=O.model.get("mark_from");var Q=O.model.get("mark_to");if(Q&&aa){ag=Q-aa+1}}return ag>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:ag}if(O.idPrefix=="qodistinctAuthorSet"){O.markedListCandidates=z("#summary_records_form").find('input[name="selectedId"]');var T=O.markedListCandidates.filter(":checked");var Z=T.map(function(){return this.value}).get();var ad=z("#summary_records_form").find('input[name="preSelectedIds"]');if(ad.length&&ad.val()){var S=_.filter(_.compact(z.trim(ad.val()).split(" ")),function(ah){return(z.inArray(ah,Z)===-1)});if(S.length||Z.length){return S.length+Z.length}}var ac=0;var ab=0;while(ab<T.length){ac=parseInt(T[ab].getAttribute("utcount"))+ac;ab++}return ac>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:ac}if(O.idPrefix=="qoIncites"){ac=document.getElementById("incitesCount").value;return ac}return z("#records_chunks").find('input[name="marked_list_candidates"]:checked').length},numberOfRecordsForRange:function(V){var R=z(V).find('[name="markFrom"]');var O=z(V).find('[name="markTo"]');if(!R.length){if(this.savedNumberOfRecordsForRange){return this.savedNumberOfRecordsForRange}return}var X=R.val();var S=O.val();var T=/^\s*(\d+)\s*$/;var P=X.match(T);var U=S.match(T);var Q=parseInt(P[1]);var W=parseInt(U[1]);this.savedNumberOfRecordsForRange=W-Q+1;return this.savedNumberOfRecordsForRange},allRecordsOnPage:function(P,R){var O=this;var Q=O.markedListCandidates.map(function(){return this.value}).get().join(";");z(R).find("#selectedIds").val(Q);z(R).find("#mark_from").val(O.markedListCandidates.first().val());z(R).find("#mark_to").val(O.markedListCandidates.last().val());z(P).find("#mark_from").val(O.markedListCandidates.first().val());z(P).find("#mark_to").val(O.markedListCandidates.last().val());return"&totalMarked="+O.markedListCandidates.length},baseUrl:function(P,S){var O=this;var R=O.getTemplateContents("BaseUrl");if(R!==null){return"/"+z.trim(R)}var Q=z(S).find('input[name="research_id"]').val();if(typeof Q==="undefined"){Q=z(P).find('input[name="research_id"]').val()}var T=z(S).find('input[name="admin_rid"]').val();if(typeof Q==="undefined"){T=z(P).find('input[name="admin_rid"]').val()}if(O.idPrefix==="mlAdd"||O.buttonClassPrefix==="ui-dialog-add"){return"/MarkRecords.do?"}else{if(O.shouldSignIn&&typeof Q==="undefined"&&typeof T==="undefined"&&(O.idPrefix==="qoRID"||O.idPrefix==="qodistinctAuthorSet")){O.quickOutputSendMessageTemplate=false;O.refreshWindow=true;O.shouldShowProcessing=false;return"/DACSLogin.do?"}else{if(O.shouldSignIn&&typeof Q!=="undefined"&&typeof T!=="undefined"&&(O.idPrefix==="qoRID"||O.idPrefix==="qodistinctAuthorSet")){O.quickOutputSendMessageTemplate=false;O.refreshWindow=true;return"/ProxyClaim.do?"}else{if(O.idPrefix==="qoRIDSignIn"){return"/DACSLoginValidation.do?action=go"}else{if(O.idPrefix==="qoproxyClaim"){return"/ProxyClaimSubmit.do?"}}}}}return"/OutboundService.do?action="+(O.action?O.action:"go")},requestUrl:function(P,R){var O=this;var Q=O.baseUrl(P,R);return window.location.protocol+"//"+window.location.host+z("#contextPath").html()+Q},postData:function(P,R,Q){var O=this;return(O.useParamHelperOnly?"":O.useBothForm||QuickOutput.isMarkedList()?z(R).serialize()+"&"+z(P).find("form").serialize():O.formName?z(R).serialize():z(P).find("form").serialize())+"&"+O.extraParams+"&"+Q},downloadFile:function(Q,S,R){var O=this;var P=z("#saveDiv");if(!P.length){P=z(document.createElement("div")).attr("id","saveDiv").css("display","none");z("body").append(P)}O.checkExportChart=function(){if((QuickOutput.selectExportType==="xls")&&!(z("#rawTCChartImageData").val()&&z("#rawPIChartImageData").val())){return setTimeout(O.checkExportChart,100)}else{O.setModel(Q,S);P.html("").append(O.deserialize(O.model.attributes,O.requestUrl(Q,S)+"&"+O.extraParams+"&"+R)).find("form").submit()}};O.checkExportChart()},handleError:function(S,R,Q){var O=this;if(typeof O.newDiv==="undefined"){return}var P=O.newDiv;if(S.status===404){z(P).html("Cannot connect. Please try again.")}else{if(R==="timeout"&&O.idPrefix=="qoIncites"){z(P).html("Sorry, your dataset was not saved. Please try again in a few minutes.")}else{z(P).dialog("option",{hide:{effect:"fade",duration:1500}});z(P).dialog("close")}}},setReturnUrl:function(P,R){var O=this;var Q=z(P).find('input[name="rurl"]').val();O.returnUrl=Q;return false},selectionParams:function(W){var O=this;if(QuickOutput.isMarkedList()){var T=z("#output_form").find('input[name="value(record_select_type)"]:checked').val();if(T==="allrecords"){var U=CURRENT_NUM_MARKED_LIST_RECORDS<=QUICK_OUTPUT_MAX_RECORDS?CURRENT_NUM_MARKED_LIST_RECORDS:QUICK_OUTPUT_MAX_RECORDS;z(W).find("#selectedIds").val("");z(W).find("#selectedIds").val("");return"&totalMarked="+U}}var V=O.markedListCandidates.filter(":checked");var P=V.map(function(){return this.value}).get();var R=z("#summary_records_form").find('input[name="preSelectedIds"]');var Q=R.length&&R.val()?_.filter(_.compact(z.trim(R.val()).split(" ")),function(X){return(z.inArray(X,P)===-1)}):[];if(O.idPrefix!="qoIncites"){var S=Q.join(";")+(P.length&&Q.length?";":"")+P.join(";");z(W).find("#selectedIds").val(S)}return"&totalMarked="+V.length},setFilters:function(O,P){if(QuickOutput.isMarkedList()){z(P).find("#filters").val(z(P).find('input[name="fields"]:checked').map(function(){return this.value}).get().join(" "));z(O).find("#filters").val(z(P).find('input[name="fields"]:checked').map(function(){return this.value}).get().join(" "))}else{z(O).find("#filters").val(z(O).find('[name="fields_selection"]').val())}},uncheckSelections:function(){var O=this;if(typeof O.markedListCandidates==="undefined"||O.markedListCandidates.length===0){O.markedListCandidates=z("#records_chunks").find('input[name="marked_list_candidates"]')}O.uncheckItems(O.markedListCandidates);var P=z(".SelectPageChk");O.uncheckItems(P);QuickOutput.pageSelected=false},uncheckItems:function(O){if(O!=null){O.filter(":checked").removeAttr("checked")}},saveDoAgain:function(O){if(!this.saveAction){return}if(this.noSaveActionOnFullRecord&&QuickOutput.isFullRecord()){return}z(".saveAgainTo").unbind("click").click(this.showOptions).children().html(z(this.saveAction).filter("a").html())},formatNumberWithcommas:function(O){var P=O.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");return P},formInvalid:function(O){var P=z(O).find("form");if(!P.length){return false}return !P.valid()},dataSetEmpty:function(){var O=document.getElementById("dataSet").value;if(O==null||O==""){return true}return false},deserialize:function(T,P){var Q=z(document.createElement("form"));P=P.replace(/\r?\n/g,"");z(Q).attr("action",z(document.createElement("div")).html(P).text()).attr("method","POST");var S=function(V,W){var U=z(document.createElement("input"));if(V==="queryNatural"){W=W.replace(new RegExp("#","g"),"")}z(U).attr("type","hidden").attr("name",V).attr("value",W).appendTo(Q)};for(var R in T){if(T[R].push){for(var O=0;O<T[R].length;O++){S(R,T[R][O])}}else{S(R,T[R])}}return Q},serialize:function(P){var Q=[];for(var O in P){Q.push(encodeURIComponent(O)+"="+encodeURIComponent(P[O]))}return Q.join("&")},setModel:function(W,R){var P=this;if(typeof P.model==="undefined"){return}var Q={};var X={};if(P.fieldsWanted){z.each(P.fieldsWanted,function(){X[this]=true})}var O=function(Z){if(Z.value.length){if(Q[Z.name]===undefined){Q[Z.name]=Z.value||""}else{if(!Q[Z.name].push){if(Q[Z.name]===Z.value){return}Q[Z.name]=[Q[Z.name]]}Q[Z.name].push(Z.value||"")}}};var T=typeof R!=="undefined"&&W!==R?[W,R]:[W];var U={};for(var Y in T){var S=T[Y];var V=z(S).serializeArray();if(typeof V==="undefined"||V.length<1){V=z(S).find("form").serializeArray()}if(P.fieldsWanted){z.each(V,function(){if(Y==0&&typeof this.value!=="undefined"&&this.value.length){U[this.name]=true}if(Y==0||!U[this.name]){if(X[this.name]){O(this)}}})}else{if(Y==0&&typeof this.value!=="undefined"&&this.value.length){U[this.name]=true}if(Y==0||!U[this.name]){z.each(V,function(){O(this)})}}}P.model.set(Q)},doAction:function(U){U.preventDefault();var P=this;if(typeof P.newDiv==="undefined"){return}var Y=P.newDiv;if(P.shouldCertifyPublicationsForRID){var aa=certifyPublicationsForRID();if(!aa){saveOutputForm("UA_output_input_form");z(".saveToMenu").filter("select").select2("close");z(Y).dialog("close");return}}if(P.formInvalid(Y)){return}if(P.idPrefix=="qoIncites"){if(P.dataSetEmpty()){document.getElementById("dataSetEmpty").style.display="";return}else{document.getElementById("dataSetEmpty").style.display="None"}}var af=QuickOutput.isMarkedList()?"#output_form":P.formName?'form[name="'+P.formName+'"]':Y;P.fixMode(Y,af);P.saveEmailAddress(Y,af);P.removeRurl(Y,af);if(P.formName&&P.noSaveAction!==true){z(af).find('input[name="action"]').val("go")}var O="";P.setReturnUrl(Y,af);z(af).find("#format").val(P.format);z(Y).find("#format").val(P.format);if(QuickOutput.isFullRecord()){O+=P.fullRecordParams(Y)}else{if(P.numberOfRecordsSelected()&&P.idPrefix!="qoIncites"){O+=P.selectionParams(af);if(P.idPrefix=="qodistinctAuthorSet"){O+="&mark_from=1&mark_to="+P.numberOfRecordsSelected()}if(QuickOutput.isMarkedList()){var ab=z("#output_form").find('input[name="value(record_select_type)"]:checked').val();var X=0;if(P.idPrefix=="qoFastSave"){X=CURRENT_NUM_MARKED_LIST_RECORDS>FAST_SAVE_MAX_RECORDS?FAST_SAVE_MAX_RECORDS:CURRENT_NUM_MARKED_LIST_RECORDS;z(Y).find('[name="mark_from"]').val(1);z(Y).find('[name="mark_to"]').val(X);z(af).find('[name="mark_from"]').val(1);z(af).find('[name="mark_to"]').val(X);z(Y).find('[name="totalMarked"]').val(X);z(af).find('[name="totalMarked"]').val(X)}else{if(ab==="allrecords"){X=CURRENT_NUM_MARKED_LIST_RECORDS>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:P.numberOfRecordsSelected();z(Y).find('[name="mark_from"]').val(1);z(Y).find('[name="mark_to"]').val(X);z(af).find('[name="mark_from"]').val(1);z(af).find('[name="mark_to"]').val(X);z(Y).find('[name="totalMarked"]').val(X);z(af).find('[name="totalMarked"]').val(X)}if(ab==="pagerecords"){var ak=P.markedListCandidates.length;var T=P.markedListCandidates[0].value;var X=parseInt(T)+parseInt(ak)-1;z(Y).find('[name="mark_from"]').val(T);z(Y).find('[name="mark_to"]').val(X);z(af).find('[name="mark_from"]').val(T);z(af).find('[name="mark_to"]').val(X);z(Y).find('[name="totalMarked"]').val(ak);z(af).find('[name="totalMarked"]').val(ak)}if(ab==="range"){var Q=z("#output_form").find('input[name="markFrom"]').val();var ad=z("#output_form").find('input[name="markTo"]').val();var Z=/^\s*(\d+)\s*$/;var ac=Q.match(Z);var ae=ad.match(Z);var aj=parseInt(ac[1]);var V=parseInt(ae[1]);var ak=V-aj+1;z(Y).find('[name="mark_from"]').val(aj);z(Y).find('[name="mark_to"]').val(V);z(af).find('[name="mark_from"]').val(aj);z(af).find('[name="mark_to"]').val(V);z(Y).find('[name="totalMarked"]').val(ak);z(af).find('[name="totalMarked"]').val(ak)}}}}else{if(P.isRangeSelected(Y,af)){P.setRangeParameters(Y,af);if(P.idPrefix=="qodistinctAuthorSet"){var al=z(Y).find('[name="markFrom"]').val();var ah=z(Y).find('[name="markTo"]').val();P.selectCheckBox(al,ah);var R=P.numberOfRecordsSelected();O+=P.selectionParams(af);O+="&mark_from=1&mark_to="+R;z(Y).find('input[name="daTotalRecords"]').val(R);if(P.formInvalid(Y)){return}}if(P.idPrefix=="qoIncites"){var ai=document.getElementById("incitesCount").value;z(Y).find('[name="mark_from"]').val(1);z(Y).find('[name="mark_to"]').val(ai);z(af).find('[name="mark_from"]').val(1);z(af).find('[name="mark_to"]').val(ai);z(Y).find('[name="totalMarked"]').val(1);z(af).find('[name="totalMarked"]').val(ai);z(Y).find("#selectedIds").val("")}}else{if(P.idPrefix=="qodistinctAuthorSet"){P.selectCheckBox();O+=P.selectionParams(af);var R=P.numberOfRecordsSelected();O+="&mark_from=1&mark_to="+R;z(Y).find('input[name="daTotalRecords"]').val(R);if(P.formInvalid(Y)){return}}if(P.idPrefix=="qoIncites"){var ai=document.getElementById("incitesCount").value;z(Y).find('[name="mark_from"]').val(1);z(Y).find('[name="mark_to"]').val(ai);z(af).find('[name="mark_from"]').val(1);z(af).find('[name="mark_to"]').val(ai);z(Y).find('[name="totalMarked"]').val(1);z(af).find('[name="totalMarked"]').val(ai);z(Y).find("#selectedIds").val("")}else{O+=P.allRecordsOnPage(Y,af)}}}P.setFilters(Y,af);var W=P.paramHelper(Y);if(W.length){O=(P.useParamHelperOnly?"":O)+"&"+W}}P.setModel(Y,af);var ag=P.requestUrl(Y,af);var S=P.postData(Y,af,O);P.savedRequestUrl=ag;P.savedPostData=S;if(P.idPrefix=="qoFastSave"&&P.fileDownload||P.useIFrame){if(!captcha.userSIDVerify){captcha.userSIDVerify=z("#captcha_token").val()}if(z("#google_recaptcha_wall").val().toLowerCase()!=="off"&&P.shouldExecuteRecaptcha&&captcha.userSIDVerify==null){captcha.validateRecaptcha();if(captcha.recaptchaVerified){P.downloadFile(Y,af,O);P.showProcessing(U);P.showConfirmation("",U)}else{return}}else{P.downloadFile(Y,af,O);P.showProcessing(U);P.showConfirmation("",U)}}else{if(P.fileDownload||P.useIFrame){P.downloadFile(Y,af,O);P.showProcessing(U);P.showConfirmation("",U)}else{if(P.newWindow&&!P.shouldPostToNewWindow){P.showProcessing(U);window.open(ag+"&"+S,"_blank");z(Y).dialog("close");P.uncheckSelections()}else{if(QuickOutput.selectExportType==="print"){P.checkExportChart=function(){if((QuickOutput.selectExportType==="print")&&!(z("#rawTCChartImageData").val()&&z("#rawPIChartImageData").val())){return setTimeout(P.checkExportChart,100)}else{S=P.postData(Y,af,O);P.showProcessing(U);z.ajax({type:"POST",url:ag,data:S,timeout:120000,success:P.showConfirmation,error:P.handleError})}};P.checkExportChart()}else{if(P.refreshWindow){P.showProcessing(U);P.uncheckSelections();z(location).attr("href",ag+"&"+S)}else{P.showProcessing(U);z.ajax({type:"POST",url:ag,data:S,timeout:120000,success:P.showConfirmation,error:P.handleError})}}}}}},doDoneAction:function(P){var O=this;if(typeof O.newDiv!=="undefined"){z(O.newDiv).dialog("close")}},doRefreshAction:function(P){var O=location.href;if(O.indexOf("ExcludeIfFromNonInterProduct")>-1){O=O.replace("ExcludeIfFromNonInterProduct","ExcludeIfReload")}if(O.indexOf("ExcludeIfFromFullRecPage")>-1){O=O.replace("ExcludeIfFromFullRecPage","ExcludeIfReload")}if(O.indexOf("excludeEventConfig")==-1){O=O+"&excludeEventConfig=ExcludeIfReload"}if(O.indexOf("exclude=")>1&&O.indexOf("InboundService.do")>1){window.location.reload()}else{window.location.replace(O)}},doCancelAction:function(P){enableAutoSubmit();P.preventDefault();var O=this;if(typeof O.newDiv!=="undefined"){z(O.newDiv).dialog("option",{hide:{effect:"fade",duration:300}});z(O.newDiv).dialog("close")}},bothRangeFieldsHaveValue:function(O){var P=true;z.each(["markFrom","markTo"],function(S,Q){var T=z(O).find('input[name="'+Q+'"]').val();var R=T.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(!R.length){P=false}});return P},bothRangeFieldsAreNumbers:function(O){var P=true;z.each(["markFrom","markTo"],function(S,Q){var T=z(O).find('input[name="'+Q+'"]').val();var R=T.replace(/^\s\s*/,"").replace(/\s\s*$/,"");if(!isPosInteger(R)){P=false}});return P},bothRangeFieldsInOrder:function(Q){var O=z(Q).find('input[name="markFrom"]').val();var P=z(Q).find('input[name="markTo"]').val();return(P-O)>=0},bothRangeFieldsInSet:function(T){var S=null;var O=document.getElementById("trueFinalResultCount");if(O==null){O=document.getElementById("hitCount.top")}if(O!=null){S=O.innerHTML.toString();if(null==S||""===S){S=O.value}}if(S!=null&&S.indexOf(",")>-1){var R=/,/g;S=parseInt(S.replace(R,""))}if(S==null){S=CURRENT_NUM_MARKED_LIST_RECORDS}if(S==null){return true}var P=parseInt(z(T).find('input[name="markFrom"]').val());var Q=parseInt(z(T).find('input[name="markTo"]').val());if(P!=0&&P<=S&&Q!=0&&Q<=S){return true}else{return false}},rangeFieldsInMaxRecordLimit:function(R){var O=this;if(O.idPrefix=="qoIncites"){return false}var S=0;if(O.idPrefix=="qoFastSave"){S=FAST_SAVE_MAX_RECORDS}else{S=(O.idPrefix==="mlAdd")?MARKED_LIST_MAX_RECORDS:QUICK_OUTPUT_MAX_RECORDS}var P=z(R).find('input[name="markFrom"]').val();var Q=z(R).find('input[name="markTo"]').val();return(Q-P+1)<=S},selectionsInMarkedListRecordLimit:function(Q){var O=this;if(O.idPrefix!=="mlAdd"){return true}var T=MARKED_LIST_MAX_RECORDS;var S=z("#MLCount");if(!S.length){return true}var P=parseInt(S.first().text().replace(new RegExp("[^0-9]","g"),""));var R=P+Q;return R<=T},prepValidator:function(P){var O=this;var Q=z(P).find("form");if(!Q.length){return}z.validator.addMethod("bothRangeFieldsHaveValue",function(S,R){if(this.optional(R)===true||!O.isRangeSelected(P)){return true}return O.bothRangeFieldsHaveValue(P)},getMessageById("quickOutputNullInARange"));z.validator.addMethod("bothRangeFieldsAreNumbers",function(S,R){if(this.optional(R)===true||!O.isRangeSelected(P)){return true}return O.bothRangeFieldsAreNumbers(P)},getMessageById("range_specialchar_error"));z.validator.addMethod("bothRangeFieldsInOrder",function(S,R){if(this.optional(R)===true||!O.isRangeSelected(P)){return true}return O.bothRangeFieldsInOrder(P)},getMessageById("range_notsequential_error"));z.validator.addMethod("bothRangeFieldsInSet",function(S,R){if(this.optional(R)===true||!O.isRangeSelected(P)){return true}return O.bothRangeFieldsInSet(P)},getMessageById("range_notinset_error"));z.validator.addMethod("rangeFieldsInMaxRecordLimit",function(S,R){if(this.optional(R)===true||!O.isRangeSelected(P)){if(O.idPrefix!=="qodistinctAuthorSet"){return true}}return O.rangeFieldsInMaxRecordLimit(P)},getMessageById((O.idPrefix=="qoFastSave")?"qo_range_morethan_fastsave_error":(O.idPrefix==="mlAdd")?"ml_range_morethan_maxrec_error":"qo_range_morethan_maxrec_error"));z.validator.addMethod("totalInMarkedListRecordLimit",function(Y,V){var T=P;if(O.idPrefix!=="mlAdd"){return true}var U=MARKED_LIST_MAX_RECORDS;var R=z("#MLCount");if(!R.length){return true}var S=parseInt(R.first().text().replace(new RegExp("[^0-9]","g"),""));var Z=z(T).find('input[name="markFrom"]').val();var W=z(T).find('input[name="markTo"]').val();var X=S+(W-Z+1);return X<=U},getMessageById("ml_total_morethan_maxrec_error"));z.validator.addMethod("totalWithPageInMarkedListRecordLimit",function(U,S){var T=P;if(O.idPrefix!=="mlAdd"||O.isRangeSelected(T)){return true}var X=MARKED_LIST_MAX_RECORDS;var W=z("#MLCount");if(!W.length){return true}var R=parseInt(W.first().text().replace(new RegExp("[^0-9]","g"),""));var V=R+O.markedListCandidates.length;return V<=X},getMessageById("ml_total_morethan_maxrec_error"));z.validator.addMethod("darangeFieldsLessThanHighestRecord",function(S,R){var T=z(P).find('input[name="daTotalRecords"]').val();return(parseInt(T)<=parseInt(QUICK_OUTPUT_MAX_RECORDS))},getMessageById("qo_range_morethan_maxrec_error"));z.validator.addMethod("rangeFieldsLessThanHighestRecord",function(T,S){if(this.optional(S)===true||!O.isRangeSelected(P)){return true}var R=z(P).find('input[name="markTo"]').val();return(parseInt(R)<=parseInt(QUICK_OUTPUT_HIGHEST_RECORDS))},getMessageById("qo_range_morethan_highestrec_error"));z.validator.addMethod("multiemail",function(T,S){if(this.optional(S)){return true}var U=T.split(/[;,]+/);valid=true;for(var R in U){T=U[R];valid=valid&&jQuery.validator.methods.email.call(this,z.trim(T),S)}return valid},jQuery.validator.messages.email);Q.validate({onfocusout:false,ignore:[],errorPlacement:function(U,V){var T=V.attr("name");if(T==="value(record_select_type)"){var W=z(V).parent().siblings();W.filter("label.error-range").remove();var X=W.filter("label.error");if(!X.length){U.addClass("error-pagerecords").insertAfter(W.last()[0])}}else{if(T==="markFrom"||T==="markTo"){var Y=z(V).parents(".number-of-records-range");Y.siblings("label.error-pagerecords").remove();var X=Y.siblings("label.error");if(!X.length){U.addClass("error-range").insertAfter(Y)}}else{if(T==="daTotalRecords"){var S=z(document.createElement("div"));S.addClass("da-error");S.insertAfter(V);U.appendTo(S)}else{var R=z(document.createElement("span"));R.addClass("xmark");R.insertAfter(V);U.insertAfter(R)}}}},rules:{emailAddress:"required multiemail",markFrom:"bothRangeFieldsHaveValue bothRangeFieldsAreNumbers bothRangeFieldsInOrder bothRangeFieldsInSet rangeFieldsInMaxRecordLimit rangeFieldsLessThanHighestRecord totalInMarkedListRecordLimit",markTo:"bothRangeFieldsHaveValue bothRangeFieldsAreNumbers bothRangeFieldsInOrder bothRangeFieldsInSet rangeFieldsInMaxRecordLimit rangeFieldsLessThanHighestRecord totalInMarkedListRecordLimit",returnEmail:"multiemail",daTotalRecords:"darangeFieldsLessThanHighestRecord","value(record_select_type)":"totalWithPageInMarkedListRecordLimit"},messages:{emailAddress:O.requiredEmailValidationError,returnEmail:O.optionalEmailValidationError},unhighlight:function(U,R,S){var T=z(U).attr("name");if(T==="value(record_select_type)"){var V=z(U).parent().siblings();var W=V.filter("label.error-pagerecords");if(W.length){W.remove()}}else{if(T==="markFrom"||T==="markTo"){z.each(["markFrom","markTo"],function(Z,Y){z(P).find('input[name="'+Y+'"]').removeClass(R)});var X=z(U).parent();var W=X.siblings("label.error-range");if(W.length){W.remove()}}else{z(U).removeClass(R);var V=z(U).siblings();V.filter("span.xmark").remove();V.filter("label."+R).first().remove()}}}})},showOptions:function(W){disable_auto_submit();var S=z(W.currentTarget).filter("#ui-active-menuitem");if(S){z(S).parent().parent().hide()}var P=z(".saveToMenu").filter("select");W.preventDefault();var O=this;if(O.idPrefix=="qoRIDSignIn"){var Z=isLoginReadyNoSubmit(loginForm);if(!Z){return}}if(O.idPrefix==="qoFastSave"&&z("#HS_EndNoteLink_signedin").length===0&&z("#fast5k_login_wall").val().toLowerCase()!=="off"){return csiovl("qoFastSave","",false)}O.saveDoAgain(W);if(O.shouldSignIn&&z("#"+O.csiId).length===1&&(O.idPrefix!=="qoRID"&&O.idPrefix!=="qodistinctAuthorSet")){var am=z("#enURL").val();if(O.idPrefix==="qoENW"&&z("#enw_signedin").val()=="false"){return csiovl("SAVEENW",am,false)}if(O.idPrefix==="qoIncites"){if(z("#incites_signedin").val()=="false"){return csiovl("INCITES",am,false)}if(z("#incites_refreshpage").val()=="true"){O.shouldRefreshAfter="true";z("#incites_refreshpage").val("false")}else{O.shouldRefreshAfter="false"}}}if(typeof O.newDiv==="undefined"){O.newDiv=z(document.createElement("div"))}if(QuickOutput.isMarkedList()&&O.invalidMarkedListOptions()){return}if(QuickOutput.isMarkedList()&&O.noOptionsOnMarkedList){return O.doAction(W)}var Y=O.newDiv;O.outputViewType=z("#loginForm").find('input[name="viewType"]').val();O.outputProxyViewType=z("#ProxyClaimForm").find('input[name="viewType"]').val();var R=O.numberOfRecordsSelected();if(O.idPrefix=="qodistinctAuthorSet"&&O.noOptionsForSelections){if(R<1){var ab=document.getElementById("selectAtLeastOneDAISYSet");alert(ab.value);return}if(R>QUICK_OUTPUT_MAX_RECORDS){document.getElementById("searchErrorMessage").style.display="";return}}if(O.idPrefix=="qoproxyClaim"){var ah=proxyAddToPubList_submit();if(ah==false){return}}if(O.idPrefix=="mlAdd"&&R>0){if(O.selectionsInMarkedListRecordLimit(R)){var ak=getRecordsForm();return mark_selected_records(ak)}alert(getMessageById("ml_total_morethan_maxrec_error"));return}var ai=null;var ad=null;if(O.idPrefix==="qoIncites"){ai=document.getElementById("IncitesEntitled").value;if(ai=="yes"){var aq=document.createElement("a");aq.setAttribute("href",window.location.href);var ag=aq.pathname;var U="";var al=ag.split("/");for(i=0;i<al.length;i++){U+="/";if(i<(al.length-1)){U+=al[i]}}getCustomDataSetInfo(aq.protocol+"//"+aq.hostname+(aq.port?":"+aq.port:"")+(U?U:"")+"/AsyncIC2DataSetNum.do?SID="+z("#SID").val()+"&product=WOS")}R=document.getElementById("incitesCount").value;ad=document.getElementById("IsAtMaxLimit").value;if(ai=="no"||R==0||ad=="1"){O.noDetails="true"}else{O.noDetails=undefined}}if(O.idPrefix=="qoFastSave"&&!QuickOutput.isMarkedList()){R=0;O.uncheckSelections()}var T=(QuickOutput.isFullRecord()||ad=="1")?"":R>0&&!(QuickOutput.selectPageTriggersRangeSelection&&QuickOutput.pageSelected)?R>1?O.recordsSelectedTemplate({selectedCount:R}):O.recordSelectedTemplate():O.numberOfRecordsTemplate();var ae=(O.idPrefix=="qoIncites"&&ai=="yes"&&ad=="0")?O.hasIncitesEntitleTemplate()():O.idPrefix=="qoIncites"&&ad=="1"?O.datasetMaxTemplate()():R;var aj=(O.idPrefix=="qoIncites"&&(R==0||ad=="1"))?O.closeActionTemplate()():(O.idPrefix=="qoIncites"&&(ai=="yes"&&ad=="0"))?O.saveActionTemplate()():(O.idPrefix=="qoIncites"&&(ai=="no"))?O.notEntitleCloseActionTemplate():O.actionButtonsTemplate()({action:O.actionTemplate()(),cancelaction:O.cancelActionTemplate()()});if(O.idPrefix=="qoIncites"&&ai=="no"){z(Y).html(O.noIncitesEntitleTemplate()({buttons:(aj)}))}else{z(Y).html(O.contentTemplate()({outputHiddenValues:O.hiddenValuesTemplate(),numberOfRecords:T,daTotalRecords:(ae),details:(O.noDetails?"":O.detailsTemplate()()),buttons:(aj)}))}if(O.idPrefix=="qoIncites"&&(R==0||ad=="1")){if(O.shouldRefreshAfter){z(Y).find("."+O.overlayCancelActionClass).click(O.doRefreshAction)}else{z(Y).find("."+O.overlayCancelActionClass).click(O.cancelAction)}}if(O.idPrefix=="qoIncites"&&ai=="no"){z(Y).find("."+O.overlayCancelActionClass).click(O.doCancelAction)}if((O.noOptionsForSelections&&(R>0||QuickOutput.isFullRecord()))||O.noOptions){return O.doAction(W)}z(P).select2("close");z(Y).dialog({dialogClass:"ui-dialog-quickoutput "+O.idPrefix,height:"auto",title:O.titleTemplate()(),modal:true,resizable:false,draggable:false,width:580,closeText:document.getElementById("lang_close").value});z(".j-custom-select").select2({dropdownAutoWidth:false,minimumResultsForSearch:8});if(O.format=="saveToIncites"||(O.idPrefix=="qoIncites"&&ai=="yes")){z(".qoIncites .ui-dialog-titlebar").hide()}if(O.idPrefix=="qoIncites"&&ai=="yes"){var Q=document.getElementById("DataSetsRemaining").value;if(Q=="1"){document.getElementById("oneDatasetInfo").style.display=""}else{if(ad=="0"){document.getElementById("multiDatasetInfo").style.display=""}}if(ad=="0"){var X=new Date();var aa=X.getFullYear();var ap=X.getMonth()+1;if(ap<10){ap="0"+ap}var an=X.getDate();if(an<10){an="0"+an}var V=X.getHours();if(V<10){V="0"+V}var af=X.getMinutes();if(af<10){af="0"+af}var ao=X.getSeconds();if(ao<10){ao="0"+ao}document.getElementById("dataSet").value="Web of Science "+an+ap+aa+":"+V+af+ao}}else{if(O.idPrefix=="qoIncites"){if(document.getElementById("saveToInCitesInstruction")){document.getElementById("saveToInCitesInstruction").style.display="none"}}}z(Y).find("."+O.overlayActionClass).click(O.doAction);z(Y).find("."+O.overlayCancelActionClass).click(O.doCancelAction);O.prepValidator(Y);if(QuickOutput.selectPageTriggersRangeSelection){var ac=QuickOutput.pageSelected?true:false;z(Y).find("#numberOfRecordsRange").prop("disabled",ac);z.each(["markFrom","markTo"],function(at,ar){z(Y).find('input[name="'+ar+'"]').prop("disabled",ac)})}z.each(["markFrom","markTo"],function(at,ar){z(Y).find('input[name="'+ar+'"]').change(function(au){z(Y).find('input[name="value(record_select_type)"][value="range"]').attr("checked","checked")})})},showProcessing:function(Q){Q.preventDefault();var O=this;if(typeof O.newDiv==="undefined"){return}var S=O.newDiv;if(!O.shouldShowProcessing){return}var P=O.numberOfProcessedRecords();var R=(O.idPrefix==="qoRIDSignIn"&&(O.outputViewType==="summary"||O.outputViewType==="distincAuthorSet"))||(O.idPrefix==="qoproxyClaim"&&(O.outputProxyViewfType==="summary"||O.outputProxyViewType==="distincAuthorSet"))||QuickOutput.isMarkedList()?P:QuickOutput.isFullRecord()&&O.idPrefix!="qoRIDSignIn"?1:O.isRangeSelected(S)&&P<1?O.numberOfRecordsForRange(S):P>=1?((P>QUICK_OUTPUT_MAX_RECORDS)&&O.idPrefix!="qoIncites")?QUICK_OUTPUT_MAX_RECORDS:P:O.markedListCandidates.length;var U=R>1?O.sendingMessageTemplate():O.sendingOneMessageTemplate();z(S).html(O.sendingTemplate({message:U({selectedCount:O.formatNumberWithcommas(R)})}));if(O.noOptions||O.noOptionsOnMarkedList){z(".saveToMenu").filter("select").select2("close");z(S).dialog({dialogClass:"ui-dialog-quickoutput",height:"auto",title:O.sendingTitleTemplate()(),modal:true,resizable:false,width:580,draggable:false,closeText:document.getElementById("lang_close").value});z(S).dialog("widget").animate({height:"100px"})}else{z(S).dialog("option",{title:O.sendingTitleTemplate()()})}if(typeof O.spinner!=="undefined"){O.spinner.spin(false)}var T=z(S).find(".spinner");T.spin({lines:12,length:4,width:2,radius:4,top:0,left:-25});z(S).find("."+O.overlayCancelActionClass).click(O.doCancelAction)},submitForm:function(S){var O=this;if(!O.autosubmitForm){return}var Q=/(<form\s+[\s\S]+<\/\s*form>)/im;var R=S.match(Q);if(!R||R.length<2){return}var P=z(document.createElement("div")).html(R[1]).css("display","none");z("body").append(P);P.find('form[name="'+O.autosubmitForm+'"]').submit();P.remove()},classText:function(R,S){var W=new RegExp('<div(?=\\s+[^=]+=[\'"][^\'"]+[\'"])*\\s+class="'+S+'"([\\s\\S]+)',"im");var T=R.match(W);if(!T||T.length<2){return""}var U=/>([\s\S]+)/im;var P=T[1].match(U);if(!P||P.length<2){return""}var V=P[1];var O=V.indexOf(">");if(O===-1||O===V.length){return""}var Q=V.indexOf("</");if(Q===-1){return""}return V.substring(0,Q)},showFormattedError:function(Q){var O=this;var P=O.newDiv;if(typeof O.newDiv!=="undefined"){if(O.showErrorButton){if(O.idPrefix=="qoIncites"){z(P).dialog("widget").animate({height:"280px"});z(P).html(O.errorTemplate()({message:Q,buttons:(O.closeActionTemplate()())}));if(O.shouldRefreshAfter){z(P).find("."+O.overlayCancelActionClass).click(O.doRefreshAction)}else{z(P).find("."+O.overlayCancelActionClass).click(O.doCancelAction)}}else{z(P).dialog("widget").animate({height:"200px"});z(P).html(O.errorTemplate()({message:Q,buttons:(O.closeActionTemplate()())}));z(P).find('input[name="errorCancel"]').click(this.doCancelAction)}}else{z(P).html(O.errorTemplate()({message:Q,buttons:""}));setTimeout(function(){z(P).dialog("close")},5000)}}},showJsonError:function(S,Q){var P=(function(){var U=/(\{[\s\S]+\})/im;var V=S.match(U);if(!V||V.length<2){return"{}"}return V[1]})();var R={};try{R=JSON.parse(P)}catch(T){return false}if(typeof R==="undefined"||typeof R.error==="undefined"||R.error.length<1){return false}var O=this;O.showFormattedError(R.error);return true},showError:function(T,R){var Q=this;var P=(function(){var W=/<div(?=\s+[^=]+=['"][^'"]+['"])*\s+class="errorMessage"([\s\S]+)/im;var V=T.match(W);if(!V||V.length<2){return""}return V[1].substr(0,512)})();var S=Q.classText(P,"errorHead");var O=Q.classText(P,"errorText");if(!O.length){return Q.showJsonError(T,R)}var U=S.length?S+": "+O:O;if(typeof Q.newDiv==="undefined"){Q.uncheckSelections();return true}Q.showFormattedError(U);return true},postToNewWindow:function(Q,P){var S=window.open("","_blank");if(typeof S==="undefined"||typeof S.document==="undefined"){return}var R=S.document.open();R.write(Q);R.close();var O=this;if(typeof O.newDiv!=="undefined"){z(O.newDiv).dialog("close")}O.uncheckSelections()},showConfirmation:function(S,Q){if(typeof Q!=="undefined"&&typeof Q.preventDefault!=="undefined"){Q.preventDefault()}var P=this;if(P.shouldPostToNewWindow){return P.postToNewWindow(S,Q)}if(typeof P.newDiv==="undefined"){P.uncheckSelections();return}var R=P.newDiv;if(P.idPrefix=="qoRIDSignIn"&&S.indexOf("Export Transfer Service")==-1&&S.indexOf("ridRegistrationForm")==-1){P.shouldBackAfter=false;try{var O=S.replace(/^[\S\s]*<body[^>]*?>/i,"").replace(/<\/body[\S\s]*$/i,"");jQuery("body").html(O)}catch(T){jQuery("body").html(S)}if(!z(R).hasClass("ui-dialog-content")){z(R).dialog({autoOpen:false,dialogClass:"ui-dialog-quickoutput",height:"auto",modal:true,resizable:false,width:580,draggable:false,closeText:document.getElementById("lang_close").value})}}if(P.idPrefix=="qoRIDSignIn"&&S.indexOf("ridRegistrationForm")!=-1){z(R).dialog("close");document.getElementById("emailPasswordError").style.display="";return}P.submitForm(S);setTimeout(function(){z(R).find(".spinner").spin(false);if(P.showError(S,Q)){return}var U=4000;z(R).dialog("option",{title:P.sentTitleTemplate()()});if(P.sentMessageTemplate){var W=(P.idPrefix=="qoRIDSignIn")?P.numberOfProcessedRecords():P.numberOfProcessedRecords(S);if(!P.hasConfirmation){z(R).dialog("widget").animate({height:"150px"})}if(P.idPrefix=="qoIncites"){z(R).find("."+P.overlayCancelActionClass).click(P.doDoneAction);z(R).dialog("widget").animate({height:"auto"});U=90000}P.outputViewType=z("#loginForm").find('input[name="viewType"]').val();P.outputProxyViewType=z("#ProxyClaimForm").find('input[name="viewType"]').val();var Z=(P.idPrefix==="qoRIDSignIn"&&(P.outputViewType=="summary"||P.outputViewType=="distincAuthorSet"))||(P.idPrefix==="qoproxyClaim"&&(P.outputProxyViewType=="summary"||P.outputProxyViewType=="distincAuthorSet"))||QuickOutput.isMarkedList()?W:QuickOutput.isFullRecord()?1:P.isRangeSelected(R)&&W<1?P.numberOfRecordsForRange(R):W>=1?((W>QUICK_OUTPUT_MAX_RECORDS)&&P.idPrefix!="qoIncites")?QUICK_OUTPUT_MAX_RECORDS:W:P.markedListCandidates.length;var X=(Z<=1&&P.idPrefix!="qoIncites")?P.sentOneMessageTemplate():P.sentMessageTemplate();z(R).html(P.sentTemplate()({message:X({processed:Z,email:(P.savedEmailAddress?P.savedEmailAddress:"")}),buttons:(P.hasConfirmation||P.idPrefix=="qoIncites"?"":P.actionButtonsTemplate()({action:P.instructionActionTemplate()(),cancelaction:P.sentCloseActionTemplate()()}))}));if(!P.hasConfirmation){z(R).find("."+P.overlayActionClass+" input").click(function(aa){aa.preventDefault();z("#saveDiv").find("form").submit()});z(R).find("."+P.overlayCancelActionClass).click(P.doCancelAction)}}else{z(R).dialog("option",{hide:{effect:"fade",duration:U}});z(R).dialog("close")}P.uncheckSelections();var Y=1500;if(P.idPrefix=="qoIncites"){if(P.shouldRefreshAfter){z(R).find("."+P.overlayCancelActionClass).click(P.doRefreshAction)}else{z(R).find("."+P.overlayCancelActionClass).click(P.doDoneAction)}z(R).dialog("widget").animate({height:"auto"});Y=6000;if(P.shouldRefreshAfter){Y=70000}}if(P.shouldRefreshAfter){setTimeout(function(){if(P.hasConfirmation){z(R).dialog("option",{hide:{effect:"fade",duration:500}});z(R).dialog("close");setTimeout(function(){var ad=z("#goToPage");if(ad.length>0){z("#goToPage").click()}else{var ac=location.href;if(ac.indexOf("ExcludeIfFromNonInterProduct")>-1){ac=ac.replace("ExcludeIfFromNonInterProduct","ExcludeIfReload")}if(ac.indexOf("ExcludeIfFromFullRecPage")>-1){ac=ac.replace("EExcludeIfFromFullRecPage","ExcludeIfReload")}if(ac.indexOf("excludeEventConfig")==-1){ac=ac+"&excludeEventConfig=ExcludeIfReload"}if(ac.indexOf("exclude=")>1&&ac.indexOf("InboundService.do")>1){window.location.reload()}else{window.location.replace(ac)}}},Y)}else{var ab=z("#goToPage");if(ab.length>0){z("#goToPage").click()}else{var aa=location.href;if(aa.indexOf("ExcludeIfFromNonInterProduct")>-1){aa=aa.replace("ExcludeIfFromNonInterProduct","ExcludeIfReload")}if(aa.indexOf("ExcludeIfFromFullRecPage")>-1){aa=aa.replace("EExcludeIfFromFullRecPage","ExcludeIfReload")}if(aa.indexOf("excludeEventConfig")==-1){aa=aa+"&excludeEventConfig=ExcludeIfReload"}if(aa.indexOf("exclude=")>1&&aa.indexOf("InboundService.do")>1){window.location.reload()}else{window.location.replace(aa)}}}},Y)}else{var V=function(){var aa=decodeURIComponent(P.returnUrl);window.location.replace(aa)};if((P.hasConfirmation||P.shouldFadeAfter)&&P.idPrefix!="qoIncites"){setTimeout(function(){z(R).dialog("option",{hide:{effect:"fade",duration:U}});z(R).dialog("close");if(P.shouldBackAfter){setTimeout(V,U)}},1500)}else{if(P.shouldBackAfter){setTimeout(V,3000)}}}},3000)}});var k=m.extend({csiId:"HS_EndNoteLink",el:z(".quickOutputENW"),extraParams:"&save_options=othersoftware",format:"saveToENW",hasConfirmation:true,idPrefix:"qoENW",newWindow:false,noOptionsOnMarkedList:true,shouldRemoveRurl:false,saveAction:".quickOutputENW",shouldRefreshAfter:true,shouldSignIn:"true",shouldShowProcessing:true,showErrorButton:true,render:function(){z(".quickOutputENW").click(function(){updateResultOptions("saveAgain","quickOutputENW")});z(".quickOutputENW").click(this.showOptions);return this}});var y=k.extend({el:z(".quickOutputRID"),format:"saveToRID",idPrefix:"qoRID",saveAction:".quickOutputRID",shouldRefreshAfter:true,shouldCertifyPublicationsForRID:true,paramHelper:function(O){var P=z(O).find('input[name="colName"]');if(P==="DIIDW"){z(O).find('input[name="mode"]').val("quickOutputForDII")}return""},render:function(){z(".quickOutputRID").click(function(){updateResultOptions("saveAgain","quickOutputRID")});z(".quickOutputRID").click(this.showOptions);return this}});var H=k.extend({el:z(".quickOutputRefWorks"),format:"saveToRefWorks",idPrefix:"qoRefWorks",saveAction:".quickOutputRefWorks",shouldRefreshAfter:false,shouldSignIn:false,autosubmitForm:"ExportRWForm",render:function(){z(".quickOutputRefWorks").click(function(){updateResultOptions("saveAgain","quickOutputRefWorks")});z(".quickOutputRefWorks").click(this.showOptions);return this}});var G=k.extend({el:z(".quickOutputIncites"),format:"saveToIncites",hasConfirmation:true,idPrefix:"qoIncites",newWindow:false,noOptionsOnMarkedList:false,shouldRemoveRurl:true,saveAction:".quickOutputIncites",shouldRefreshAfter:false,shouldSignIn:"true",shouldShowProcessing:true,showErrorButton:true,fileDownload:false,render:function(){z(".quickOutputIncites").click(function(){updateResultOptions("saveAgain","quickOutputIncites")});z(".quickOutputIncites").click(this.showOptions);return this}});var C=Backbone.View.extend({el:z(".saveToButton"),quickOutputTemplate:_.template(z("#quickOutputTemplate").html()),initialize:function(){_.bindAll(this,"render");this.render();return this},render:function(){this.$el.html(this.quickOutputTemplate());var O=new A({model:new N()});var S=new M({model:new N()});var R=new k({model:new N()});var U=new y({model:new N()});var V=new H({model:new N()});var W=new n({model:new N()});var P=new L({model:new N()});var T=new G({model:new N()});this.$el.show();this.$el.css({visibility:"visible"});if(z(".saveToMenu").length){var Q=z(".saveToMenu").filter("select");Q.change(function(Y){Y.preventDefault();var X=Y.currentTarget.value;switch(X){case"fecyt":O.showOptions(Y);break;case"enw":R.showOptions(Y);break;case"rid":U.showOptions(Y);break;case"refworks":V.showOptions(Y);break;case"endnote":W.showOptions(Y);break;case"incites":T.showOptions(Y);break;case"pansforderpict":P.showOptions(Y);break;case"other":default:S.showOptions(Y)}z(Q).val(X).trigger("change.select2")});Q.select2().val("")}return this}});var w=C.extend({el:z(".cr_saveToButton_top"),quickOutputTemplate:_.template(z("#cr_quickOutputTemplate").html()),render:function(){this.$el.html(this.quickOutputTemplate());var R=new l();var Q=new B();R.$el.parent().buttonset().next().hide().menu();var S=new h({model:new N()});var P=new o({model:new N()});this.$el.show();this.$el.css({visibility:"visible"});if(z(".saveToMenu").length){var O=z("#cr_saveToMenu").filter("select").select2({dropdownAutoWidth:true,minimumResultsForSearch:Infinity});O.change(function(U){U.preventDefault();var T=U.currentTarget.value;switch(T){case"xls":if(typeof crCharts!=="undefined"&&crCharts!==null){QuickOutput.selectExportType="xls";crCharts.publishedItems.renderExportChart();crCharts.timesCited.renderExportChart()}P.showOptions(U);break;case"other":default:S.showOptions(U)}z(O).val(T).trigger("change.select2")});O.val("")}return this}});var d=C.extend({el:z(".cr_saveToButton"),quickOutputTemplate:_.template(z("#cr_quickOutputTemplate").html()),render:function(){this.$el.html(this.quickOutputTemplate());var R=new l();var Q=new B();R.$el.parent().buttonset().next().hide().menu();var S=new h({model:new N()});var P=new o({model:new N()});this.$el.show();this.$el.css({visibility:"visible"});if(z(".saveToMenu").length){var O=z("#cr_saveToMenu").filter("select").select2({dropdownAutoWidth:true,minimumResultsForSearch:Infinity});O.change(function(U){U.preventDefault();var T=U.currentTarget.value;switch(T){case"xls":if(typeof crCharts!=="undefined"&&crCharts!==null){QuickOutput.selectExportType="xls";crCharts.publishedItems.renderExportChart();crCharts.timesCited.renderExportChart()}P.showOptions(U);break;case"other":default:S.showOptions(U)}z(O).val(T).trigger("change.select2")});O.val("")}return this}});var e=m.extend({el:z(".formatForPrintButton"),format:"formatForPrint",idPrefix:"qoPrint",newWindow:true,noOptionsOnMarkedList:true,shouldRemoveRurl:true,});var s=m.extend({el:z(".fastSaveButton"),format:"fastSave",idPrefix:"qoFastSave",newWindow:true,noOptionsOnMarkedList:false,shouldExecuteRecaptcha:true,shouldShowProcessing:true,showErrorButton:true,fileDownload:true,numberOfRecordsTemplate:_.template(z("#qoFastSaveNumberOfRecordsTemplate").html()),shouldRemoveRurl:true});var x=m.extend({el:z(".saveToEmailButton"),format:"email",hasConfirmation:true,idPrefix:"qoEmail",newWindow:false,shouldFadeAfter:true,shouldRemoveRurl:false,shouldShowProcessing:true});var q=m.extend({el:z(".addToMarkedListButton"),format:false,idPrefix:"mlAdd",noOptionsOnMarkedList:true,refreshWindow:true,shouldRemoveRurl:true,shouldShowProcessing:true});var t=m.extend({el:z(".ridSignInButton"),format:"saveToRID",formName:"loginForm",hasConfirmation:true,idPrefix:"qoRIDSignIn",noOptions:true,shouldRefreshAfter:false,refreshWindow:false,shouldBackAfter:true,shouldRemoveRurl:false,shouldShowProcessing:true,returnUrl:"",render:function(){z(".ridSignInButton").click(this.showOptions);return this},numberOfProcessedRecords:function(P){if(typeof P==="undefined"){var O=this;var R=z("#loginForm");var T=z(R).find('input[name="viewType"]').val();if(typeof T==="undefined"){R=z("#ProxyClaimForm");T=z(R).find('input[name="viewType"]').val()}if(T=="fullRecord"){return 1}if(T=="distincAuthorSet"){var V=z(R).find('input[name="mark_from"]').val();var W=z(R).find('input[name="mark_to"]').val();var S=W-V+1;return S>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:S}if(T=="summary"){var U=O.model.get("totalMarked");if(!U){var V=z(R).find('input[name="mark_from"]').val();var W=z(R).find('input[name="mark_to"]').val();if(W&&V){U=W-V+1}}return U>QUICK_OUTPUT_MAX_RECORDS?QUICK_OUTPUT_MAX_RECORDS:U}}var X=/<input(?:\s+\S+)+\s+name="numRecords"\s+value="(\d+)"[^>]*?>/;var Q=P.match(X,"gim");if(!Q||Q.length<2){return 0}return parseInt(Q[1])}});var g=m.extend({el:z(".distinctAuthorSetButton"),format:"saveToRID",formName:"claim_pub_form",hasConfirmation:true,idPrefix:"qodistinctAuthorSet",noOptionsOnMarkedList:true,noOptionsForSelections:true,shouldCertifyPublicationsForRID:true,shouldRefreshAfter:false,refreshWindow:false,shouldRemoveRurl:false,shouldSignIn:true,shouldShowProcessing:true,returnUrl:"",paramHelper:function(O){return"viewType=distincAuthorSet"},render:function(){var O=this;z(window).load(function(){z(".distinctAuthorSetButton").unbind("click");z(".distinctAuthorSetButton").click(O.showOptions)});return O}});var f=m.extend({el:z(".proxyClaimButton"),format:"saveToRID",formName:"ProxyClaimForm",hasConfirmation:true,idPrefix:"qoproxyClaim",noOptionsOnMarkedList:true,noOptionsForSelections:true,shouldRefreshAfter:false,refreshWindow:false,shouldBackAfter:true,shouldRemoveRurl:false,shouldShowProcessing:true,returnUrl:"",render:function(){z.when(z(".proxyClaimButton").click(this.showOptions)).done(function(){z(".proxyClaimButton").show()});return this}});var M=m.extend({el:z(".quickOutputOther"),fileDownload:true,format:"saveToFile",idPrefix:"qoOther",saveAction:".quickOutputOther",shouldRemoveRurl:false,shouldShowProcessing:true,render:function(){z(".quickOutputOther").click(function(){updateResultOptions("saveAgain","quickOutputOther")});z(".quickOutputOther").click(this.showOptions);return this}});var A=M.extend({el:z(".quickOutputFECYT"),extraParams:"&save_options=fecyt",format:"saveToFile",idPrefix:"qoFECYT",saveAction:".quickOutputFECYT",shouldRefreshAfter:false,shouldSignIn:false,noOptionsForSelections:true,shouldShowProcessing:true,noOptionsOnMarkedList:true,autosubmitForm:"ExportRWForm",hasConfirmation:false,render:function(){z(".quickOutputFECYT").click(function(){updateResultOptions("saveAgain","quickOutputFECYT")});z(".quickOutputFECYT").click(this.showOptions);return this}});var h=M.extend({el:z(".cr_quickOutputOther"),extraParams:"save_options=csv",fileDownload:true,formName:"summary_records_form",format:"crsaveToFile",idPrefix:"qoCROther",noOptionsForSelections:true,noOptionsOnMarkedList:true,shouldShowProcessing:true,noSaveAction:true,numberOfRecordsTemplate:_.template(z("#qoCRNumberOfRecordsTemplate").html()),saveAction:".cr_quickOutputOther",render:function(){z(".cr_quickOutputOther").click(function(){updateResultOptions("CitationReport:saveAgain","cr_quickOutputOther")});z(".cr_quickOutputOther").click(this.showOptions);return this}});var o=h.extend({el:z(".crQuickOutputXLS"),extraParams:"save_options=xls",idPrefix:"qoCRXLS",formName:"summary_records_form",noOptionsForSelections:true,shouldShowProcessing:true,noOptionsOnMarkedList:true,noSaveAction:true,numberOfRecordsTemplate:_.template(z("#qoCRNumberOfRecordsTemplate").html()),saveAction:".crQuickOutputXLS",render:function(){z(".crQuickOutputXLS").click(function(){updateResultOptions("CitationReport:saveAgain","crQuickOutputXLS")});z(".crQuickOutputXLS").click(this.showOptions);return this}});var n=M.extend({el:z(".quickOutputEndNote"),extraParams:"&save_options=othersoftware",format:"saveToRef",idPrefix:"qoEndNote",noOptionsOnMarkedList:true,saveAction:".quickOutputEndNote",render:function(){z(".quickOutputEndNote").click(function(){updateResultOptions("saveAgain","quickOutputEndNote")});z(".quickOutputEndNote").click(this.showOptions);return this}});var L=M.extend({el:z(".pansForDerpict"),extraParams:"&save_options=pans4derpict",format:"saveToFile",idPrefix:"qoOther",noOptionsOnMarkedList:true,saveAction:".pansForDerpict",render:function(){z(".pansForDerpict").click(function(){updateResultOptions("saveAgain","pansForDerpict")});z(".pansForDerpict").click(this.showOptions);return this}});var v=e.extend({el:z(".crFormatForPrintButton"),format:"crformatForPrint",formName:"summary_records_form",idPrefix:"qoCRPrint",noOptionsForSelections:true,noOptionsOnMarkedList:true,noSaveAction:true,numberOfRecordsTemplate:_.template(z("#qoCRNumberOfRecordsTemplate").html()),mode:"outputService",shouldPostToNewWindow:true,shouldShowProcessing:true});var c=x.extend({el:z(".crSaveToEmailButton"),extraParams:"&save_options=tabWinUnicode",format:"cremail",formName:"summary_records_form",idPrefix:"qoCREmail",noOptionsOnMarkedList:true,noSaveAction:true,shouldRemoveRurl:true,numberOfRecordsTemplate:_.template(z("#qoCRNumberOfRecordsTemplate").html()),useBothForm:true,mode:"outputService"});var p=new C({model:new N()});var J=new d({model:new N()});var b=new w({model:new N()});var a=new x({model:new N()});var u=new e({model:new N()});var D=new s({model:new N()});var F=new c({model:new N()});var j=new v({model:new N()});var I=new q({model:new N()});var K=new t({model:new N()});var r=new f({model:new N()});var E=new g({model:new N()});z(function(){if(!QuickOutput.selectionsAvailable()){z(".summary_quickTopButtons").hide()}QuickOutput.removeAddToENWButton()});if(QuickOutput.isSafari){z.event.props=z.event.props.join("|").replace("layerX|layerY|","").split("|")}z.extend(z.validator.messages,{email:z("#qoEmailValidationError").html()});z(".addToMarkedList").click(I.showOptions)})(jQuery);$(".select2-selection__rendered").on("mouseup touchend",function(g){var c=$(".saveToMenu");var f=$(c).get(0);$(f).select2("close");var d=$(g.currentTarget).text();var b=$(f).children();var a;$.each(b,function(h,e){if($(e).text()==d){a=$(e).val();return false}});$(f).val(a).trigger("change")});function initSelect2(){$(".j-custom-select").select2({dropdownAutoWidth:false,minimumResultsForSearch:8})}$('input[name="fastSave"]').click(function(){captcha.userSIDVerify=$("#captcha_token").val();if(!captcha.userSIDVerify&&captcha.recaptchaVerified==true){captcha.userSIDVerify=captcha.token}if($("#google_recaptcha_wall").val().toLowerCase()!=="off"&&!captcha.userSIDVerify&&$("#HS_EndNoteLink_signedin").length!==0){$(".quickoutput-overlay-buttonset").css("visibility","hidden");var a=$("#recaptchaRenderUrl").first().text();$.when($.ajax({type:"GET",url:a,success:function(b){$("#qoFastSaveRecaptcha").html(b)},error:function(){(".quickoutput-overlay-buttonset").css("visibility","visible");captcha.recaptchaVerified==true}})).then(function(){setTimeout(function(){$(".quickoutput-overlay-buttonset").css("visibility","visible")},1500);setTimeout(function(){grecaptcha.execute()},1500)})}});